# Rules for openstack controller created by LIP
*nat
:PREROUTING ACCEPT [7:328]
:INPUT ACCEPT [7:328]
:OUTPUT ACCEPT [6738:414224]
:POSTROUTING ACCEPT [6738:414224]
:nova-api-OUTPUT - [0:0]
:nova-api-POSTROUTING - [0:0]
:nova-api-PREROUTING - [0:0]
:nova-api-float-snat - [0:0]
:nova-api-snat - [0:0]
:nova-postrouting-bottom - [0:0]
-A PREROUTING -j nova-api-PREROUTING
-A OUTPUT -j nova-api-OUTPUT
-A POSTROUTING -j nova-api-POSTROUTING
-A POSTROUTING -j nova-postrouting-bottom
-A nova-api-snat -j nova-api-float-snat
-A nova-postrouting-bottom -j nova-api-snat
COMMIT
# Completed on Thu Aug 25 14:40:13 2016
# Generated by iptables-save v1.4.21 on Thu Aug 25 14:40:13 2016
*mangle
:PREROUTING ACCEPT [65972:35553986]
:INPUT ACCEPT [65972:35553986]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [60102:8168517]
:POSTROUTING ACCEPT [60102:8168517]
:nova-api-POSTROUTING - [0:0]
-A POSTROUTING -j nova-api-POSTROUTING
COMMIT
# Completed on Thu Aug 25 14:40:13 2016
# Generated by iptables-save v1.4.21 on Thu Aug 25 14:40:13 2016
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:nova-api-FORWARD - [0:0]
:nova-api-INPUT - [0:0]
:nova-api-OUTPUT - [0:0]
:nova-api-local - [0:0]
:nova-filter-top - [0:0]
-A INPUT -p tcp -m multiport --ports 80 -m comment --comment "openstack dashboard" -j ACCEPT
-A INPUT -p tcp -m multiport --ports 8080 -m comment --comment "openstack swift" -j ACCEPT
-A INPUT -p tcp -m multiport --ports 8000,8004 -m comment --comment "openstack heat" -j ACCEPT
-A INPUT -p tcp -m multiport --ports 9696 -m comment --comment "openstack neutron" -j ACCEPT
-A INPUT -p tcp -m multiport --ports 8776 -m comment --comment "openstack cinder" -j ACCEPT
-A INPUT -p tcp -m multiport --ports 8773,8774,8775,6080 -m comment --comment "openstack nova" -j ACCEPT
-A INPUT -p tcp -m multiport --ports 9292,9191 -m comment --comment "openstack glance" -j ACCEPT
-A INPUT -p tcp -m multiport --ports 5000 -m comment --comment "openstack keystone" -j ACCEPT
-A INPUT -j nova-api-INPUT
-A INPUT -s {{ openstack_cidr }} -p tcp -m multiport --dports 5672,5671 -j ACCEPT
-A INPUT -s {{ openstack_controller_ip }}/24 -p tcp -m multiport --dports 4369,25672 -j ACCEPT
-A INPUT -j LOG
-A FORWARD -j nova-filter-top
-A FORWARD -j nova-api-FORWARD
-A OUTPUT -j nova-filter-top
-A OUTPUT -j nova-api-OUTPUT
-A nova-api-INPUT -p tcp -m tcp --dport 8775 -m addrtype --dst-type LOCAL -j ACCEPT
-A nova-filter-top -j nova-api-local
COMMIT

